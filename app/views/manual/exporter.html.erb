<div class="page-header">
  <h2><%= title %></h2>
</div>


<h3>利用の流れ</h3>

<div class="container">
  <p>
    <%= image_tag 'home/admiral_stats_concept.png', class: 'img-responsive img-thumbnail', width: 600 %>
  </p>
  <p>
    1. 公式サイトからプレイデータをエクスポート
  </p>
  <p>
    2. エクスポートしたプレイデータを、「インポート」の画面でアップロード
  </p>
  <div class="row">
    <div class="col-sm-10">
      <div class="panel panel-danger">
        <div class="panel-heading">
          <h3 class="panel-title">注意事項</h3>
        </div>
        <div class="panel-body">
          （非公式ツールである旨の説明）
        </div>
      </div>
    </div>
  </div>
</div>

<hr>

<h3>3種類のエクスポータ</h3>

<div class="container">
  <p>
    現在は、3種類のエクスポータを提供しています。Admiral Stats を使いたい環境に応じて、好きなエクスポータを選んでください。<br>
    手軽に使うだけならブックマークレット版、PC 上にきちんとプレイデータを溜めたい方には PowerShell 版や Ruby 版をお勧めします。
  </p>
</div>

<div class="container">
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
      <tr>
        <th class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-1">エクスポータ</th>
        <th class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-xs-1">対応 OS</th>
        <th class="col-xl-9 col-lg-9 col-md-9 col-sm-10 col-xs-10">特徴</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>ブックマークレット版</td>
        <td>Windows<br>MacOS<br>Android</td>
        <td>
          <ul style="margin-left: -20px; margin-bottom: 0px;">
            <li><strong class="text-primary">インストールは最も簡単</strong></li>
            <li>スマホでも使える</li>
            <li>ダウンロード先フォルダはブラウザ次第のため、ファイルが散らばりがち</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>PowerShell 版</td>
        <td>Windows</td>
        <td>
          <ul style="margin-left: -20px; margin-bottom: 0px;">
            <li>インストールはブックマークレット版の次に簡単</li>
            <li>ダウンロード先フォルダが固定で、ファイルが散らばらない</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>Ruby 版</td>
        <td>Windows<br>MacOS<br>Linux</td>
        <td>
          <ul style="margin-left: -20px; margin-bottom: 0px;">
            <li>インストールは最も難しいが、Ruby が動作する OS 全般で動く</li>
            <li>ダウンロード先フォルダが固定で、ファイルが散らばらない</li>
            <li><strong class="text-primary">実験的な機能（Admiral Stats へのインポート自動化など）は Ruby 版から追加予定</strong></li>
          </ul>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<hr>

<h3>エクスポータ（ブックマークレット版）の使い方</h3>

<h4>インストール方法</h4>

<div class="container">
  <p>
    以下のいずれかのリンクを、ブラウザのブックマークツールバーにドラッグアンドドロップしてください。これでインストール完了です。
  </p>
  <div class="well">
    <p>
      <%= link_to 'ASE（Admiral Stats エクスポータ）3ファイル版', "javascript:(function(u){var%20s=document.createElement('script');s.charset='UTF-8';s.src=u;document.body.appendChild(s)})('https://www.admiral-stats.com/bookmarklets/exporter.js');", class: 'btn btn-primary' %>
    </p>
    現在の Admiral Stats がサポートしている、3種類のプレイデータ（基本情報、艦娘図鑑、艦娘一覧）をダウンロードします。
  </div>
  <div class="well">
    <p>
      <%= link_to 'ASE（Admiral Stats エクスポータ）全ファイル版', "javascript:(function(u){var%20s=document.createElement('script');s.charset='UTF-8';s.src=u;document.body.appendChild(s)})('https://www.admiral-stats.com/bookmarklets/exporter_all.js');", class: 'btn btn-primary' %>
    </p>
    現在はサポートしていませんが、将来的にサポートする可能性のある、すべてのプレイデータをダウンロードします。
  </div>
  <p>
    Android の場合は、<strong class="text-danger">ドラッグアンドドロップでのブックマークレット登録ができません。</strong><br>
    そのため、Windows/MacOS の Chrome でブックマークレットを登録してから、それを Chrome の機能で Android に同期してください。
  </p>
</div>

<h4>実行方法</h4>

<div class="container">
  <h5>ログイン</h5>
  <div class="container">
    <p>
      まず、<%= link_to 'SEGA 公式のプレイヤーズサイトのログイン画面', 'https://kancolle-arcade.net/ac/#/top', target: '_blank' %> からログインします。
    </p>
    <p>
      <%= image_tag 'manual/sega_top.jpg', class: 'img-responsive img-thumbnail', width: 600 %>
    </p>
  </div>

  <h5>エクスポートしたい提督情報の選択（※ 一部の提督に限る）</h5>
  <div class="container">
    <p>
      1個の SEGA ID に2個以上の提督情報を紐付けている場合に限り、ログイン直後に以下のようなページが表示されます。<br>
      エクスポートしたい提督情報を選んで、「決定」ボタンを押してください。
    </p>
    <p>
      <%= image_tag 'manual/sega_registration.jpg', class: 'img-responsive img-thumbnail', width: 600 %>
    </p>
  </div>

  <h5>ブックマークレットの実行</h5>
  <div class="container">
    <p>
      ログイン完了すると、以下のような海域情報のページが表示されます。この画面で先ほど登録したブックマークレットをクリックしてください。<br>
      プレイデータを含むファイルが、自動的にダウンロードされます。
    </p>
    <p>
      <%= image_tag 'manual/sega_area.jpg', class: 'img-responsive img-thumbnail', width: 600 %>
    </p>
  </div>

  <h5>エクスポートしたプレイデータのアップロード</h5>
  <div class="container">
    <p>
      最後に、<%= link_to_if_logged_in 'Admiral Stats の「インポート」ページ', import_url %> に移動して、ファイルをアップロードすれば作業完了！<br>
      艦これアーケードをプレイするたびにプレイデータをインポートしていけば、艦娘カードの枚数やレベルがどれくらいのペースで増えているか確認できるようになります。
    </p>
    <p>
      <%= image_tag 'manual/import.jpg', class: 'img-responsive img-thumbnail', width: 600 %>
    </p>
  </div>
</div>

<hr>

<h3>エクスポータ（PowerShell 版、Ruby 版）の使い方</h3>

<h4>インストール・実行方法</h4>

<div class="container">
  <p>
    <%= link_to 'エクスポータの配布サイト(GitHub)', exporter_url, target: '_blank' %> に詳しい説明を掲載していますので、こちらをご覧ください。
  </p>
  <p>
    <%= link_to image_tag('manual/github_exporter.png', class: 'img-responsive img-thumbnail', width: 600), exporter_url, target: '_blank' %>
  </p>
</div>
